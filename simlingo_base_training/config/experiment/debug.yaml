# @package _global_
# Debug experiment configuration for SimLingo base training
# Base training uses a simpler model architecture without full multimodal capabilities
# Optimized for quick iteration on a single GPU

# Hydra defaults - compose configuration
defaults:
  - /data_module: carla_no_buckets  # Data loading without bucketed sampling
  - /model/vision_model: llavanext  # LLaVA-NeXT vision model architecture

# Model hyperparameters
model:
  lr: 3e-5  # Learning rate for language model parameters
  vision_lr: 3e-5  # Learning rate for vision encoder (can be different from LM)
  predict_route_as_wps: True  # Predict route as waypoints
  speed_wps_mode: '2d'  # Waypoint mode: 2D coordinates

  # Language model configuration
  language_model:
    variant: tiny  # Tiny variant for faster debugging
    lora: False  # No LoRA for base model (full fine-tuning)
    _target_: simlingo_base_training.models.language_model.llama.Llama  # Model class to instantiate

  # Vision model configuration
  vision_model:
    downsample_feature_grid_factor: 2  # Reduce spatial resolution of vision features by 2x

# Data loading and preprocessing
data_module:
  data_path: database/simlingo  # Path to SimLingo dataset
  batch_size: 4  # Batch size for training
  num_workers: 0  # No parallel workers (easier debugging)

  # Route and history configuration
  route_as: target_point  # Simpler route representation (just target point, no command)
  hist_len: 1  # Use single historical frame

  # Image preprocessing
  cut_bottom_quarter: False  # Keep full image (no cropping)
  use_global_img: False  # Don't use global/bird's-eye view images

  # Data augmentation
  img_shift_augmentation: True  # Apply random image shifts
  img_shift_augmentation_prob: 0.5  # 50% chance of shift augmentation
  image_enhancing: True  # Apply image enhancement (brightness, contrast, etc.)

# Training schedule
max_epochs: 30  # Maximum training epochs (more than full model due to simpler architecture)
val_every_n_epochs: 2  # Validate every 2 epochs

# Debug and logging
debug: true  # Enable debug mode (additional logging, checks)
gpus: 1  # Single GPU for debugging
wandb_name: debug  # Weights & Biases experiment name